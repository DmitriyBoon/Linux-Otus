# Устанавливаем Graylog

Настройка после уставки сервера 

* 1.	Переходим по адресу https://Ваш_сервер в панель администрирования
 
* 2.	В интерфейсе, панель навигации 
 

* 3.	Search – поиск по всем событиям, используя все inputs и экстракторы. Поддерживает регулярные выражения.
 
Пример запросов: 
Сообщения, содержащие ssh:
ssh
Сообщения, содержащие термин ssh или login:
ssh login
Сообщения, содержащие точную фразу авторизации SSH:
"ssh login
Сообщения, где в поле поле login:
type:ssh
Сообщения, где поле включает ssh или login:
Тип:(ssh login)
Сообщения, где в поле включает точную фразу SSH login:
Тип:"SSH login

* 4.	Steams – возможность разделить потоки
 

* 5.	Alerts –  уведомления, возможность при наступлении определенных событий слать уведомления.
* 6.	Dashboard – вывод отсортированной информации ввиде : графиков, диаграмм, таблиц, виджетов и карт.
  

Возможность делать не ограниченное количество таких экранов информации по нужной тематике. 
* 7.	Sources – информация о хостах передающих логи
 
* 8.	System – меню с системными настройками.
 

* 9.	Inputs – добавление источников траффика
 

Выбираем нужный тип получения обычно это syslog.
 

Вводим настройки, тут все просто. 
Важно: Порты назначаются не ниже 1025

 

Тут видим информацию о поступающих логах
 
Переходим в просмотр поступающих логов

 
Здесь мы можем делать все теже действия что в П.1 Search только по конкретному источнику(inputs)

 
Сортировать информацию по полям и т.п. действия 

* 10.	Добавить поле или парсинг сообщения
Раскрываем сообщение, выбираем сообщение которые будет разбирать в данном случае message 
Далее Create extractor for field message > Regular expression
 

Переходим в создание нового поля с помощью регулярного сообщения. Тут видим
Для какого inputs делает поле, пример сообщения и поля для правил сообщения.
 

В данном случае хотим получить имя пользователя, завершившего сессию.
Вот так выглядит сообщение pam_unix(sudo:session): session closed for user root
Нужно выделить имя, тут все просто если нет спец символов, определяем шаблон
В Regular expression user (.+) 
Это значит что будет взята и выделена строка после user, жмем try получаем результат
  

Если нас результат устраивает сохраняем его. 
Заполняем название поля и название заголовка поля

# Настройка клиентов, с помощью ansible 

Берем playbook, вносим свои изменения в переменные. После установки наболюдаем данные в input  
 


